# Dataset Information

This project requires specific PyTorch tensor files for anomaly detection, OOD detection, and adversarial attack testing.

**Dataset files and generated results are NOT included in this repository.**

## üìÇ Required Data Files

### Input Files

These files should be placed in the `data/` directory before running:

**Blue Team Inputs:**
- `AD_val.pt` - Anomaly detection validation set (2,000 images)
- `AD_test.pt` - Anomaly detection test set (10,000 images)
- `OOD_val.pt` - Out-of-distribution validation set (5,000 images)
- `OOD_test.pt` - Out-of-distribution test set (10,000 images)
- `dataset.pt` - Training data (CIFAR-10 grayscale)
- `model_chkpt.pt` - Pre-trained ResNet-8 model

**Red Team Additional:**
- Blue Team trained models (generated by running blue-team.ipynb):
  - `ocsvm_anomaly_detector.pkl`
  - `vae_anomaly_detector.pt`
  - `mahalanobis_ood_detector.pt`

### Output Files (Generated by Notebooks)

These are **created when you run the notebooks** and should NOT be committed to the repository:

**Blue Team Outputs:**
- `results/1.pt` - OCSVM predictions
- `results/2.pt` - VAE predictions
- `results/3.pt` - Mahalanobis predictions
- Trained detector models (listed above)

**Red Team Outputs:**
- `test_subset_clean.pt` - Clean test samples (every 10th image)
- `adversarial_attack_results.pt` - Generated adversarial examples

## üìã Data Format Specifications

### Image Data Format
- **Type:** PyTorch tensors (`.pt` files)
- **Image size:** 32√ó32 grayscale
- **Format:** `torch.Tensor` with shape `(N, 1, 32, 32)` where N = number of samples
- **Value range:** [0, 1] (normalized pixel values)

### Label Format
- **Type:** PyTorch tensors
- **Classes:** 10 classes (CIFAR-10)
- **Format:** Integer labels 0-9

### Model Checkpoint Format
- **Type:** PyTorch state dict
- **Architecture:** ResNet-8
- **Expected keys:** Standard ResNet layer names

## üîß Using Your Own Data

To run this project with your own data:

### Option 1: Use CIFAR-10
1. Download CIFAR-10 dataset
2. Convert to grayscale 32√ó32 images
3. Create train/validation/test splits
4. Save as PyTorch tensors (.pt format)
5. Add corruptions for anomaly detection sets
6. Add OOD samples (e.g., faces, non-CIFAR objects)

### Option 2: Use Custom Dataset
The code can be adapted for other image datasets:
- Modify image preprocessing in notebooks
- Adjust ResNet architecture for different input sizes
- Update class counts and labels

## üìù Example Loading Code
```python
import torch

# Load data
data = torch.load('data/AD_val.pt')
images = data['images']  # Shape: (2000, 1, 32, 32)
labels = data['labels']  # Shape: (2000,)

# Load pre-trained model
model = torch.load('data/model_chkpt.pt')
```

## üö´ .gitignore

This repository includes a `.gitignore` file that excludes:
```
# Data files
*.pt
*.pkl

# Results
results/
```

This ensures data files and generated results are not accidentally committed.

## üìä Data Statistics (Reference)

**Anomaly Detection:**
- Normal samples: ~50% of validation/test sets
- Anomalous samples: ~50% (corrupted with noise, blur, rotation, etc.)

**OOD Detection:**
- In-distribution: 50% (CIFAR-10 classes)
- Out-of-distribution: 50% (human faces, non-CIFAR objects)

**Red Team:**
- Attack success rates: Up to 99.4% (untargeted)
- Mean L2 perturbation: ~22-23 (imperceptible)
---
